Хранение данных:
1) клиники (clinics)
2) врачи (doctors)
3) клиенты (clients)
4) журнал заисанных (registrations)

1) Оценим число клиник
Даже если предположить, что на каждые 10 тысяч граждан будет по клинике (что вряд ли),
то получится 150 млн. граждан / 10 тыс. = 15 тыс. клиник.
Вывод: все клиники можем хранить в одной таблице (шардинг не требуется)
Структура таблицы:
CREATE TABLE clinics (
    id SMALLINT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY,  -- SMALLINT до 65535
    title varchar(100) NOT NULL
) ENGINE=InnoDB DEFAULT CHARACTER SET=utf8;


2) Оценим число врачей
Предположим с запасом, что в среднем 30 врачей в клинике.
15 тыс. клиник * 30 = 450 тыс. врачей. Пошардить не помешает.
Вывод: сделаем шардинг на 5 таблиц по остатку от деления clinic_id на 5 (чтобы можно было 1-им запросом выбирать врачей из конкретной клиники).
В будущем, при необходимости, всегда можно будет переразбить шардинг на большее число таблиц.

CREATE TABLE doctors_{$clinic_id % 5} (
    id MEDIUMINT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY,  -- MEDIUMINT до 16777215
    clinic_id SMALLINT UNSIGNED NOT NULL,
    name varchar(100) NOT NULL,
    INDEX `clinic_id` (`clinic_id`)
) ENGINE=InnoDB DEFAULT CHARACTER SET=utf8;


3) Мы не будем заставлять пользователей регистрироваться, но будем с них брать номер телефона и имя.
Их надо будет где-то временно хранить (до тех пор, пока день, на который записывался этот человек не окажется в прошлом).
Для этого весьма подойдет Redis.
Для нумерации клиентов заведем счетчик в Redis и будем периодически его обнулять (чтобы он не переполнялся)

4) Оценим число записей
Допустим, что врач работает 8 часов и принимает по 30 минут, т.е. до 16-ти человек в день.
Причем работают 2/3 врачей (у кого-то выходной, кто-то в отпуске, кто-то болеет)
2/3 * 450 тыс. врачей * 16 = 4 миллиона 800 тысяч записей в день. За неделю - почти 35 млн. записей.
Буду исходить из того, что запись идет на неделю вперед (считая текущий день).
Тогда пошардим таблицу на 7+1 дней (доп.день - чтобы всегда были таблицы, которые не используются, их будем во время неиспользования чистить).
Но т.к. в день почти 5 млн. записей, то дополнительно пошардим на 10 таблиц по clinic_id (до 500 тыс. записей в таблице получится).
Итого (7+1) * 10 = 80 таблиц.


CREATE TABLE registrations_{$dayNum % 8}_{$clinic_id % 10} (
    clinic_id SMALLINT UNSIGNED NOT NULL,
    doctor_id MEDIUMINT UNSIGNED NOT NULL,  -- MEDIUMINT до 16777215
    client_id INT UNSIGNED NOT NULL,        -- MEDIUMINT тут явно недостаточно (т.к. только за неделю - 35 млн.), поэтому используем INT
    INDEX `clinic_doctor` (`clinic_id`, `doctor_id`)
) ENGINE=InnoDB DEFAULT CHARACTER SET=utf8;


